# JavaScript 正则表达式进阶教程

正则表达式（Regular Expression, 简称 **regex**）是一种用来匹配字符串模式的工具，在 JavaScript 中常用于 **搜索、替换、验证** 等操作。

---

## 1. 基本语法

正则表达式有两种写法：

1. 字面量形式：

```js
const regex = /abc/;
```

2. 构造函数：

```js
const regex = new RegExp("abc");
```

---

## 2. 常用元字符

| 符号      | 含义                                                                 | 备注                |
| ------- | ------------------------------------------------------------------ | ----------------- |
| `.`     | 匹配除换行符以外的任意单个字符                                                    | 需配合 `s` 修饰符时可匹配换行 |
| `^`     | **在正则整体开头**：匹配字符串开头；<br>**在字符类开头**：取反；<br>**在字符类中非开头**：匹配 `^` 字符本身 | 多义符号，要结合位置理解      |
| `$`     | 匹配字符串的结尾                                                           | 结合 `m` 可匹配每行结尾    |
| `*`     | 重复 0 次或多次                                                          |                   |
| `+`     | 重复 1 次或多次                                                          |                   |
| `?`     | 重复 0 次或 1 次（可选项）                                                   |                   |
| `{n}`   | 重复 n 次                                                             |                   |
| `{n,}`  | 重复至少 n 次                                                           |                   |
| `{n,m}` | 重复 n 到 m 次                                                         |                   |
| `\`     | 转义符，用来匹配特殊字符                                                       |                   |

示例：

```js
/^a.*/       // 以 a 开头的任意字符串
/\d{3}/      // 匹配 3 位数字
/[^a-z]/      // 匹配非小写字母
```

---

## 3. 字符类（Character Class）

字符类用 `[]` 表示：

| 表达式      | 含义                 |
| -------- | ------------------ |
| `[abc]`  | 匹配 a、b 或 c 中的任意一个  |
| `[a-z]`  | 匹配任意小写字母           |
| `[A-Z]`  | 匹配任意大写字母           |
| `[0-9]`  | 匹配任意数字             |
| `[^abc]` | 匹配除了 a、b、c 以外的任意字符 |
| `[a^b]`  | 匹配 a、^ 或 b         |

---

## 4. 预定义字符类

| 表达式  | 含义                                 |
| ---- | ---------------------------------- |
| `\d` | 数字（0-9），等价于 `[0-9]`                |
| `\D` | 非数字                                |
| `\w` | 单词字符（字母、数字、下划线），等价于 `[A-Za-z0-9_]` |
| `\W` | 非单词字符                              |
| `\s` | 空白字符（空格、制表符、换行符等）                  |
| `\S` | 非空白字符                              |

---

## 5. 分组、捕获与选择

* **分组**：使用 `()`，可以把多个字符当作一个整体。
* **选择**：使用 `|`，表示“或”。
* **捕获分组**：括号内的匹配结果会保存起来。
* **非捕获分组**：`(?:...)`，只分组，不捕获。

示例：

```js
/(cat|dog)/       // 匹配 cat 或 dog
/(\d{3})-(\d{4})/  // 匹配类似 123-4567 的格式
/(?:abc)+/        // 匹配一个或多个 abc，但不捕获
```

---

## 6. 零宽断言（Lookaround）

* **正向前瞻**：`x(?=y)` —— 匹配 x，要求后面跟着 y
* **负向前瞻**：`x(?!y)` —— 匹配 x，要求后面不能跟 y
* **正向后顾**：`(?<=y)x` —— 匹配 x，要求前面是 y
* **负向后顾**：`(?<!y)x` —— 匹配 x，要求前面不是 y

示例：

```js
/\d+(?=px)/     // 匹配带 px 的数字（不包含 px）
/(?<!-)\d+/     // 匹配前面不是减号的数字
```

> ⚠️ 注意：后顾断言 `(?<=...)` 在部分旧版 JS 引擎中不支持。

---

## 7. 常用方法

### 7.1 `test()`

检查字符串是否匹配正则，返回 `true` 或 `false`。

```js
/hello/.test("hello world"); // true
```

### 7.2 `match()`

返回匹配到的内容（数组形式）。

```js
"abc123".match(/\d+/); // ["123"]
```

### 7.6 `matchAll()`

返回“所有匹配”的可迭代对象（迭代器），每个结果项与 `exec` 返回结构相同（含分组、index、input、groups）。必须给正则加上 `g` 修饰符，否则会抛出 `TypeError`。

```js
const s = "a1b22c333";
[...s.matchAll(/\d+/g)].map(m => m[0]); // ["1", "22", "333"]
for (const m of s.matchAll(/\d+/g)) {
  console.log(m[0], m.index); // "1" 1, "22" 3, "333" 6
}
```

对比：
- `match(/re/g)`：返回“匹配到的字符串列表”，不含分组与索引。
- `matchAll(/re/g)`：返回迭代器，含分组与索引，需要展开或遍历使用。

### 7.3 `replace()`

替换匹配到的内容。

```js
"hello 123".replace(/\d+/, "***"); // "hello ***"
```

### 7.4 `split()`

用正则作为分隔符切割字符串。

```js
"a,b;c".split(/[;,]/); // ["a", "b", "c"]
```

### 7.5 `exec()`

返回详细的匹配结果（含捕获分组）。

```js
/(\d+)-(\d+)/.exec("123-456"); // ["123-456", "123", "456"]
```

---

## 8. 修饰符（Flags）

| 修饰符 | 含义                        |
| --- | ------------------------- |
| `g` | 全局匹配（找到所有匹配项）             |
| `i` | 忽略大小写                     |
| `m` | 多行模式（`^` 和 `$` 匹配每行开头和结尾） |
| `s` | 单行模式（`.` 可以匹配换行符）         |
| `u` | 使用 Unicode 模式             |

示例：

```js
/abc/gi.test("ABC"); // true
```

---

## 9. 实用案例

### 9.1 验证邮箱

```js
const emailRegex = /^[\w.-]+@[\w.-]+\.[a-zA-Z]{2,}$/;
emailRegex.test("test@example.com"); // true
```

### 9.2 验证手机号（中国大陆）

```js
const phoneRegex = /^1[3-9]\d{9}$/;
phoneRegex.test("13812345678"); // true
```

### 9.3 提取所有数字

```js
"价格: 100元, 税: 20元".match(/\d+/g); // ["100", "20"]
```

### 9.4 过滤非数值字符

```js
const regex = /[^\d.+-]/g;
"12a3.4b".replace(regex, ""); // "123.4"
```

---

## 10. 总结

* `^` 和 `$` 位置不同，意义也不同。整体开头/结尾 vs. 字符类里的取反。
* **复杂字符串处理** 常用到分组、断言、修饰符。
* 常用方法：`test`、`match`、`replace`、`split`、`exec`。
* 实际应用：表单验证、数据提取、格式化。

👉 建议多用 **在线正则测试工具**（如 [regex101.com](https://regex101.com)）来练习和调试。
